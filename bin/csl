#!/bin/bash
set -euo pipefail

selected=$(curl -s https://www.zotero.org/styles-files/styles.json \
  | jq -r '.[] | "\(.name)\t\(.title)"' \
  | fzf --query="${1:-}" --with-nth=2 --delimiter='\t')

if [ -n "$selected" ]; then
  url="https://www.zotero.org/styles/$(echo "$selected" | awk -F'\t' '{print $1}')"
  echo -n "$url" | pbcopy
  echo "Copied: $url"
fi
